<div class="mat-display-1 clickable" [routerLink]="['/adv-search']">
  Advanced Search
</div>

<form (ngSubmit)="onSubmit()" [formGroup]="form">
  <div
    fxLayout="row wrap"
    fxLayout.lt-md="column"
    fxLayoutAlign="space-between"
    fxLayoutAlign.lt-md="center center"
    fxLayoutGap="1rem grid"
    fxLayoutGap.lt-md="1rem"
  >
    <app-dynamic-form-input
      *ngFor="let formField of formFields"
      fxFlex="33%"
      [input]="formField"
      [form]="form"
    ></app-dynamic-form-input>
  </div>
  <div fxLayout="row" fxLayout.lt-md="column">
    <button
      mat-stroked-button
      class="full-width"
      color="primary"
      fxFlex.lt-md
      fxFlex.gt-md="50%"
    >
      Search
    </button>
    <button
      mat-stroked-button
      class="full-width"
      color="accent"
      fxFlex.lt-md
      fxFlex.gt-md="50%"
      (click)="form.reset()"
      type="button"
    >
      Clear
    </button>
  </div>
</form>

<mat-divider class="space-top"></mat-divider>

<div id="results" fxLayout="column" fxLayoutGap="1rem">
  <mat-spinner
    fxLayoutAlign="center center"
    *ngIf="isLoadingResults"
  ></mat-spinner>

  <div
    *ngIf="advSearchResponse$ | async as advSearchResponse"
    fxLayout="column"
    fxLayoutGap="1rem"
  >
    <button
      mat-stroked-button
      class="full-width"
      fxFlex.lt-md
      fxFlex.gt-md="50%"
      (click)="onAddAll()"
      type="button"
    >
      Add all
    </button>

    <table
      class="mat-elevation-z8"
      mat-table
      [dataSource]="advSearchResponse.content"
      matSort
      matSortActive="created"
      matSortDisableClear
      matSortDirection="desc"
    >
      <!-- Artist Column -->
      <ng-container matColumnDef="artist-name">
        <th mat-header-cell *matHeaderCellDef>Artist</th>
        <td mat-cell *matCellDef="let row">{{ row.artistName }}</td>
      </ng-container>

      <!-- Album Column-->
      <ng-container matColumnDef="album-name">
        <th mat-header-cell *matHeaderCellDef>Album</th>
        <td mat-cell *matCellDef="let row">{{ row.albumName }}</td>
      </ng-container>

      <!-- Title Column -->
      <ng-container matColumnDef="title">
        <th mat-header-cell *matHeaderCellDef>Title</th>
        <td mat-cell *matCellDef="let row">{{ row.title }}</td>
      </ng-container>

      <!-- Length column -->
      <ng-container matColumnDef="length">
        <th mat-header-cell *matHeaderCellDef>Duration</th>
        <td mat-cell *matCellDef="let row">
          {{ row.length | secondsToMmSs }}
        </td>
      </ng-container>

      <!-- Button: Play track -->
      <ng-container matColumnDef="play-title">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let track">
          <button
            mat-button
            (click)="addPlayTrack(track)"
            title="Play this track"
          >
            <mat-icon> play_arrow</mat-icon>
          </button>
        </td>
      </ng-container>

      <!-- Button: Add track to queue -->
      <ng-container matColumnDef="add-title">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let track">
          <button
            mat-button
            (click)="onAddTrack(track)"
            title="Add this track to the queue"
          >
            <mat-icon>add </mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
  </div>
  <div [hidden]="advSearchResponse.content.length === 0">
    <mat-paginator
      [length]="advSearchResponse.totalElements"
      [pageIndex]="advSearchResponse.number"
      [pageSize]="advSearchResponse.size"
    ></mat-paginator>
  </div>
</div>
