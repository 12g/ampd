<app-browse-navigation [filterDisabled]="true"></app-browse-navigation>

<div class="page-title">Albums</div>

<div class="flex flex-col md:flex-row justify-between">
  <mat-form-field
    appearance="fill"
    [ngClass]="{ 'dark-theme': darkTheme | async }"
  >
    <mat-label>Sort by</mat-label>
    <mat-select
      [(ngModel)]="selected"
      name="sortByKey"
      (selectionChange)="onSortBy($event.value)"
    >
      <mat-option
        *ngFor="let sortByKey of sortByKeys"
        [value]="sortByKey.value"
      >
        {{ sortByKey.viewValue }}
      </mat-option>
    </mat-select>
  </mat-form-field>

  <!--Filter-->
  <div>
    <mat-form-field>
      <input
        #searchInput
        matInput
        placeholder="Filter albums"
        autocomplete="off"
        type="text"
        [(ngModel)]="filter"
        (keydown.escape)="resetFilter()"
        (keyup)="applyFilter($event.target)"
      />
      <button
        *ngIf="filter"
        matSuffix
        mat-icon-button
        aria-label="Clear"
        (click)="resetFilter()"
      >
        <mat-icon>close</mat-icon>
      </button>
    </mat-form-field>
  </div>
</div>

<mat-divider></mat-divider>

<div class="grid place-items-center">
  <mat-spinner *ngIf="isLoading | async"></mat-spinner>
</div>

<div *ngIf="pagedAlbums$ | async as pagedAlbums">
  <div class="grid grid-cols-1 md:grid-cols-4 gap-x-6 gap-y-12">
    <app-album-item
      *ngFor="let album of pagedAlbums.content"
      [album]="album"
    ></app-album-item>
  </div>

  <div
    [hidden]="pagedAlbums.content.length === 0 || pagedAlbums.totalPages < 2"
  >
    <mat-paginator
      [length]="pagedAlbums.totalElements"
      [pageIndex]="pagedAlbums.number"
      [pageSize]="pagedAlbums.size"
      [pageSizeOptions]="[]"
      [showFirstLastButtons]="pagedAlbums.totalPages > 1"
      (page)="handlePage($event)"
    ></mat-paginator>
  </div>
</div>
