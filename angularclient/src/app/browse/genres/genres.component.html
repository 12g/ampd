<app-navigation [filterDisabled]="true"></app-navigation>

<div
  fxLayout="row wrap"
  fxLayoutAlign="space-between"
  fxLayoutAlign.lt-md="center center"
  fxLayoutGap="1rem"
>
  <a
    class="genre"
    mat-stroked-button
    color="primary"
    [queryParams]="{ genre: genre }"
    [routerLink]="['/browse/genres']"
    *ngFor="let genre of genres | async"
  >
    {{ genre }}
  </a>
</div>

<div
  *ngIf="isLoadingResults | async"
  fxLayout="row"
  fxLayoutAlign="space-around"
>
  <mat-spinner></mat-spinner>
</div>

<div id="results">
  <div *ngIf="trackTableData !== null && (genrePayload | async) as payload">
    <mat-divider></mat-divider>
    <h1 class="genre-header">Genre: {{ payload.genre }}</h1>
    <mat-tab-group
      dynamicHeight
      [(selectedIndex)]="selectedIndex"
      (selectedTabChange)="scrollDown()"
    >
      <!-- Albums -->
      <mat-tab label="Albums">
        <div *ngIf="payload.albums.content.length > 0; else noAlbums">
          <div class="gallery-grid">
            <app-album-item
              *ngFor="let album of payload.albums.content"
              [album]="album"
            ></app-album-item>
          </div>
          <mat-paginator
            *ngIf="payload.albums.totalPages > 1"
            [length]="payload.albums.totalElements"
            [pageIndex]="payload.albums.number"
            [pageSize]="payload.albums.numberOfElements"
            (page)="onAlbumPageChange($event)"
            showFirstLastButtons="true"
          >
          </mat-paginator>
        </div>
        <ng-template #noAlbums>
          <div class="not-found">No albums found.</div>
        </ng-template>
      </mat-tab>
      <!-- Tracks -->
      <mat-tab label="Tracks">
        <div *ngIf="payload.tracks.content.length > 0; else noTracks">
          <app-track-data-table
            *ngIf="payload"
            [trackTableData]="trackTableData"
          ></app-track-data-table>
        </div>
        <ng-template #noTracks
          ><div class="not-found">No tracks found.</div></ng-template
        >
      </mat-tab>
    </mat-tab-group>
  </div>
</div>
